<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Analytics & Insights - VCC</title>
    <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
    <header class="topbar">
        <div class="brand">
            <img src="/static/images/logo.svg" alt="logo" class="logo" />
            <h1>Virtual Career Counselor</h1>
        </div>
        <nav class="nav">
            <a class="btn-soft" href="/">ğŸ  Home</a>
            <a class="btn-soft" href="/dashboard">ğŸ“Š Dashboard</a>
            <a class="btn-soft" href="/career-explore">ğŸ” Explore</a>
            <a class="btn-soft" href="/courses">ğŸ“š Courses</a>
            <a class="btn-soft" href="/job-insights">ğŸ’¼ Jobs</a>
            <a class="btn-soft" href="/profile">ğŸ‘¤ Profile</a>
            <a class="btn-soft" href="/resume-builder">ğŸ“„ Resume</a>
            <a class="btn-soft" href="/interview-prep">ğŸ¤ Interview</a>
            <a class="btn-soft" href="/career-match">ğŸ¯ Match</a>
            <a class="btn-soft" href="/analytics">ğŸ“Š Analytics</a>
            <a class="btn-soft" href="/saved-jobs">ğŸ”– Saved</a>
            <a class="btn-soft" href="/settings">âš™ï¸ Settings</a>
            <details class="nav-more">
                <summary class="btn-soft">âœ¨ More</summary>
                <div class="nav-more-menu">
                    <a class="btn-soft" href="/salary-negotiation">ğŸ’° Salary</a>
                    <a class="btn-soft" href="/company-insights">ğŸ¢ Companies</a>
                    <a class="btn-soft" href="/mentors">ğŸ‘¥ Mentors</a>
                    <a class="btn-soft" href="/forum">ğŸ’¬ Forum</a>
                    <a class="btn-soft" href="/learning-paths">ğŸ“š Paths</a>
                    <a class="btn-soft" href="/referrals">ğŸ¤ Refer</a>
                    <a class="btn-soft" href="/connections">ğŸ¤ Connections</a>
                    <a class="btn-soft" href="/leaderboard">ğŸ† Leaderboard</a>
                </div>
            </details>
            <a class="btn-soft" href="/logout">ğŸšª Logout</a>
        </nav>
    </header>

    <div class="container">
        <div class="card">
            <h2>ğŸ“Š Analytics & Career Insights</h2>
            <p>Track your progress and get data-driven insights</p>

            <div class="analytics-grid">
                <div class="analytics-card">
                    <h3>ğŸ“ˆ Progress Overview</h3>
                    <div id="progressStats"></div>
                </div>

                <div class="analytics-card">
                    <h3>ğŸ¯ Activity Performance</h3>
                    <div id="activityStats"></div>
                </div>

                <div class="analytics-card">
                    <h3>ğŸ’¼ Job Applications</h3>
                    <div id="applicationStats"></div>
                </div>

                <div class="analytics-card">
                    <h3>ğŸ† Gamification</h3>
                    <div id="gamificationStats"></div>
                </div>
            </div>

            <div class="insights-section">
                <h3>ğŸ’¡ Career Insights</h3>
                <div id="careerInsights"></div>
            </div>
        </div>
    </div>

    <script>
        async function loadAnalytics() {
            const res = await fetch('/api/analytics');
            if (res.ok) {
                const data = await res.json();
                
                // Progress Stats
                document.getElementById('progressStats').innerHTML = `
                    <div class="stat-item">
                        <div class="stat-value">${data.progress.activities}%</div>
                        <div class="stat-label">Activities Completed</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${data.roadmapsCount}</div>
                        <div class="stat-label">Roadmaps Created</div>
                    </div>
                `;

                // Activity Stats
                document.getElementById('activityStats').innerHTML = `
                    <div class="stat-item">
                        <div class="stat-value">${data.completedCount} / ${data.activitiesCount}</div>
                        <div class="stat-label">Activities Completed</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${data.averageScore}%</div>
                        <div class="stat-label">Average Score</div>
                    </div>
                `;

                // Application Stats
                document.getElementById('applicationStats').innerHTML = `
                    <div class="stat-item">
                        <div class="stat-value">${data.applicationsCount}</div>
                        <div class="stat-label">Total Applications</div>
                    </div>
                `;

                // Gamification Stats
                const gam = data.gamification || {};
                document.getElementById('gamificationStats').innerHTML = `
                    <div class="stat-item">
                        <div class="stat-value">Level ${gam.level || 1}</div>
                        <div class="stat-label">Current Level</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${gam.xp || 0} XP</div>
                        <div class="stat-label">Total Experience</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${gam.streak || 0} ğŸ”¥</div>
                        <div class="stat-label">Login Streak</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${(gam.badges || []).length}</div>
                        <div class="stat-label">Badges Earned</div>
                    </div>
                `;

                // Career Insights
                const insights = [];
                if (data.progress.activities < 50) {
                    insights.push('ğŸ’¡ Complete more activities to improve your career readiness score.');
                }
                if (data.averageScore < 70) {
                    insights.push('ğŸ“š Consider reviewing quiz materials to improve your scores.');
                }
                if (data.applicationsCount === 0) {
                    insights.push('ğŸ’¼ Start applying to jobs to track your application progress.');
                }
                if (gam.streak && gam.streak >= 7) {
                    insights.push('ğŸ”¥ Great job maintaining your daily login streak!');
                }

                document.getElementById('careerInsights').innerHTML = insights.length > 0 
                    ? insights.map(i => `<div class="insight-item">${i}</div>`).join('')
                    : '<div class="insight-item">ğŸ‰ You\'re doing great! Keep up the excellent work!</div>';
            }
        }

        loadAnalytics();
        setInterval(loadAnalytics, 30000); // Refresh every 30 seconds
    </script>
</body>
</html>
